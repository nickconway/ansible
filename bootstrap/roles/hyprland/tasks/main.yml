---
- name: Check for Hyprland File
  stat:
    path: ~/.hyprland
  register: hyprland

- block:
    - name: Install Hyprland Packages
      command: >
        yay -S --noconfirm --needed
          hyprland
          cpio
          meson
          sddm
          nwg-look
          qt5ct
          qt6ct
          hyprpaper
          hyprpicker
          hypridle
          hyprlock
          hyprcursor
          xdg-desktop-portal-hyprland
          xdg-desktop-portal-gtk
          xdg-desktop-portal
          wl-clipboard
          rofi-wayland
          waybar
          wtype
          yazi
          imagemagick
          swaync-git
          thunar
          nautilus
          kdeconnect
          network-manager-applet
          brightnessctl
          pavucontrol
          pamixer
          papirus-icon-theme
          breeze-default-cursor-theme
          cliphist
          flatpak
          grim
          slurp
          feh
          noto-fonts-emoji
          kvantum
          qt5-quickcontrols
          qt5-quickcontrols2
          qt5-graphicaleffects
          xdg-user-dirs
          feh
          ungoogled-chromium-bin
          leptonica
          tesseract
          wf-recorder
          satty
          qrencode
          topgrade
          gnu-netcat
          hyprland-qtutils
          bitwarden-bin
      changed_when: false

    - name: Download Orchis Theme
      git:
        repo: https://github.com/vinceliuice/Orchis-theme.git
        dest: ~/.local/source/orchis
      register: orchis

    - name: Install Orchis
      shell:
        cmd: ./install.sh --tweaks black
        chdir: ~/.local/source/orchis
      when: orchis.changed

    - name: Install Hyprspace
      command: hyprpm update && hyprpm add https://github.com/KZDKM/Hyprspace && hyprpm enable Hyprspace
      changed_when: false
      tags:
        - hyprpm
        - hyprspace

    - name: Install Hyprchroma
      command: hyprpm update && hyprpm add https://github.com/alexhulbert/HyprChroma && hyprpm enable hyprchroma
      changed_when: false
      tags:
        - hyprpm
        - hyprchroma

    - name: Create Tessdata Directory
      file:
        path: ~/.local/share/tessdata
        state: directory
      tags:
        - tesseract

    - name: Download Tesseract Best Data
      get_url:
        url: https://github.com/tesseract-ocr/tessdata_best/raw/main/eng.traineddata
        dest: ~/.local/share/tessdata/eng.traineddata
      tags:
        - tesseract

    - name: Install Pyprland
      shell:
        cmd: yes | sh <(curl -s https://raw.githubusercontent.com/hyprland-community/pyprland/main/scripts/get-pypr)
      changed_when: false
  when: "hyprland.stat.exists"
